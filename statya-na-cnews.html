<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head>
<meta http-equiv="Content-type" content="text/html;charset=UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<link rel="stylesheet" href="main.css" type="text/css" />
<link rel="stylesheet" href="blog.css" type="text/css" />
<link rel="stylesheet" href="assets/highlight/styles/corpse.css" type="text/css" />
<link rel="alternate" type="application/rss+xml" title="" href="feed.rss" />
<link rel="shortcut icon" href="/images/favicon.ico" type="image/x-icon">
<link rel="icon" href="/images/favicon.ico" type="image/x-icon">
<script src="assets/jquery.min.js"></script>
<script src="assets/jouele/jouele.min.js"></script>
<link href="assets/jouele/jouele.min.css" rel="stylesheet"/>
<script src="assets/highlight/highlight.pack.js"></script>
<script>hljs.initHighlightingOnLoad();</script>
<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
   (function(m,e,t,r,i,k,a){m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};
   m[i].l=1*new Date();k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)})
   (window, document, "script", "https://mc.yandex.ru/metrika/tag.js", "ym");

   ym(52451890, "init", {
        id:52451890,
        clickmap:true,
        trackLinks:true,
        accurateTrackBounce:true
   });
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52451890" style="position:absolute; left:-9999px;" alt="" /></div></noscript>
<!-- /Yandex.Metrika counter -->
<title>Статья на cnews</title>
</head><body>
<div id="divbodyholder">
<div class="headerholder">
<a href="https://vk.com/evgeniy_shumilov" target="_blank"><img src="/images/logo.png" class="logo" height="106pt" style="float: left; margin-right: 20px;"></a>
<div class="header">
<div id="title">
<h1 class="nomargin"><a class="ablack" href="https://shumiloff.ru/index.html">Зайчатки разума</a></h1>
<div id="description">Записная книжка айтишника</div>
</div></div>
<ul class="full-width">
    <li>
        <a href="/pro-lyubov-k-minimalizmu-i-staticheskuyu-generaciyu-kontenta.html">О блоге</a>
<!--
        <ul>
            <li><a href="#">Item1</a></li>
            <li><a href="#">Item2</a></li>
            <li><a href="#">Item3</a></li>
        </ul>
-->
    </li>
    <li><a href="/all_tags.html">Теги</a></li>
    <li><a href="/all_posts.html">Все посты</a></li>
    <li><a href="/tag_ностальгия.html">Ностальгическое</a></li>
    <li><a href="/tag_мысли-вслух.html">Мысли вслух</a></li>
</ul>

<div class="ya-site-form ya-site-form_inited_no" onclick="return {'action':'https://yandex.ru/search/site/','arrow':false,'bg':'#b2b525','fontsize':12,'fg':'#000000','language':'ru','logo':'rw','publicname':'Поиск по shumiloff.ru','suggest':true,'target':'_self','tld':'ru','type':3,'usebigdictionary':true,'searchid':2336348,'input_fg':'#999999','input_bg':'#222222','input_fontStyle':'normal','input_fontWeight':'bold','input_placeholder':'Поиск живёт тут','input_placeholderColor':'#787A19','input_borderColor':'#999999'}"><form action="https://yandex.ru/search/site/" method="get" target="_self" accept-charset="utf-8"><input type="hidden" name="searchid" value="2336348"/><input type="hidden" name="l10n" value="ru"/><input type="hidden" name="reqenc" value=""/><input type="search" name="text" value=""/><input type="submit" value="Найти"/></form></div><style type="text/css">.ya-page_js_yes .ya-site-form_inited_no { display: none; }</style><script type="text/javascript">(function(w,d,c){var s=d.createElement('script'),h=d.getElementsByTagName('script')[0],e=d.documentElement;if((' '+e.className+' ').indexOf(' ya-page_js_yes ')===-1){e.className+=' ya-page_js_yes';}s.type='text/javascript';s.async=true;s.charset='utf-8';s.src=(d.location.protocol==='https:'?'https:':'http:')+'//site.yandex.net/v2.0/js/all.js';h.parentNode.insertBefore(s,h);(w[c]||(w[c]=[])).push(function(){Ya.Site.Form.init()})})(window,document,'yandex_site_callbacks');</script>
</div>
<div id="divbody"><div class="content">
<!-- entry begin -->
<h3><a class="ablack" href="statya-na-cnews.html">
Статья на cnews
</a></h3>
<!-- bashblog_timestamp: #202305271412.18# -->
<div class="subtitle">2023-05-27 14:12:18 &mdash; 
Evgeniy Shumilov
</div>
<!-- text begin -->

<p style="text-align:center"><img alt="" src="images/rukovoditel.jpg" /></p>

<p>&nbsp; Почти три года назад у меня родился замечательный сын. Потом я получил должность технического директора в нашей компании, потом случилась ипотека и переезд, который растянулся практически на полгода и, как и любой переезд, сопровождался миллионом дел и забот - одним словом, количество свободного времени устремилось не то что к нулю, а в пространство отрицательных чисел. Это можно заметить и по количеству статей, которые появлялись на моём блоге ранее по нескольку штук в неделю, а теперь раз в год. Это печально, хотелось бы больше времени посвящать и блогу, но пока к сожалению, это нереально.</p>

<p><br />
&nbsp; А между тем произошло множество событий в моей жизни, о которых я почти забыл, но хотелось бы помнить. Например, я заслужил звание &quot;Руководитель года&quot;, а 31го января 2023го года вышла <a href="https://cnews.ru/link/a19175" target="_blank">моя статья на cnews</a>, которую я хотел бы привести и тут.</p>

<hr />
<h2>4 сложности переходного периода у стартапа и способы их преодоления <strong> </strong></h2>

<p>Существует такое понятие: &laquo;ошибка выжившего&raquo;. Оно означает, что, принимая решение, человек опирается только на примеры &laquo;выживших&raquo;, или тех, кто добился успеха, но при этом не учитывает статистику по тем, у кого не получилось прийти к желаемому результату, поскольку данных о них мало или они отсутствуют. О том, как трансформировать стартап в ИТ-компанию, рассуждает Евгений Шумилов, технический директор &laquo;Юникорн&raquo; (разработчик платформы для умных зданий Ujin).</p>

<h2 style="text-align:justify"><span>Плюсы и минусы стартапов</span></h2>

<p><span>Стартапов существует бессчетное множество, но, как известно, успеха добиваются далеко не все. Обычно мы слышим истории только о тех, что смогли выжить. </span>Мало находится желающих делиться историей своей неудачи.<span> </span>Когда продукт не просто жив, но и развивается на протяжении нескольких лет, это уже говорит о многом<span>. Особенно, если существуют игроки, действующие в том же поле и работающие над сходными или пересекающимися по функционалу продуктами, готовые занять освободившиеся ниши. Живой сапер автоматически может считаться профессионалом своего дела.</span></p>

<p><span>Каковы отличительные признаки стартапа? Это всегда быстрое прототипирование, бешеные скорости разработки, не всегда верные с архитектурной точки зрения решения, и это вполне объяснимо. Требуется с помощью минимума ресурсов получить работающий, пусть и неидеально, продукт для проверки своих гипотез </span>&mdash; <span>нужен ли он рынку в принципе, что в нем необходимо изменить или доработать, чтобы максимально соответствовать запросам потребительской аудитории.</span></p>

<p>Стартапов существует бессчетное множество, но, как известно, успеха добиваются далеко не все.</p>

<p><span>Создание продукта в таком режиме </span>&mdash; <span>это, можно сказать, &laquo;разведка боем&raquo;. Обычно создается каркас проекта, но для оптимизации и детальной проработки нет ни времени, ни ресурсов. И если стартап выжил, то далее он проходит некую стадию стабилизации: продукт обрастает функционалом, учитываются требования и пожелания заказчиков, выстраиваются стратегии развития и т.д. При этом разработка по-прежнему идет в форсированном режиме. В этот период главное &mdash; выжить, найти баланс между источниками финансирования, объемом и квалификацией штата, подобрать правильный, соответствующий задаче инструментарий для возможности обработки входящих запросов на развитие функционала.</span></p>

<p><span>С одной стороны, хорошо, когда гипотезы подтверждаются, продукт начинает пользоваться спросом и появляется много заказчиков. С другой стороны, каждый заказчик или партнер может иметь свое видение продукта, свои требования и запросы. Два заказчика могут иметь совершенно разные взгляды на то, как должен работать один и тот же функционал, и в этом случае продукт обрастает большим количеством опций. В погоне за скоростью и желанием удовлетворить клиентов разработка под давлением бизнеса неизбежно идет на компромиссы, внедряя решения, которые не всегда идеально вписываются в изначально заложенную архитектуру проекта. Как лебедь, рак и щука, заказчики могут тянуть проект в разные стороны, выдвигая исполнителю порой чуть ли не взаимоисключающие требования.</span></p>

<p><span>С одним заказчиком можно договориться и объяснить, почему реализовать функционал определенным образом будет логичнее и лучше для него самого, с другим договориться не удается и приходится применять нетривиальные решения. Задача усложняется, когда заказчиков десятки, и </span>необходима такая реализация функционала, которая удовлетворит всех.</p>

<p><span>Сами по себе продукты также имеют крайне разный уровень сложности. Если необходимо написать игру &laquo;Крестики-нолики&raquo;, то на это хватит одного разработчика. Но если у вас есть десятки входящих запросов на реализацию функционала, web-интерфейс, четыре мобильных приложения, более сотни интеграционных модулей и около 250 зависимых друг от друга репозиториев с кодом, в которых что-то ежедневно изменяют более 70 человек, а еще более тысячи связанных таблиц в базе данных, то поддержание продукта такого рода становится похоже на игру в трехмерные шахматы, причем после каждого хода на доске появляются новые фигуры, а сама доска прирастает новыми клетками.</span></p>

<p><span>Без правильно построенных бизнес-процессов и без стратегии работа над таким проектом рано или поздно зайдет в тупик. Переход к формированию этих процессов можно назвать стадией взросления программного продукта.</span></p>

<h2><span><strong>Трудности переходного периода</strong></span></h2>

<p><span>Итак, каковы основные сложности переходного периода продукта, с которыми нам пришлось столкнуться, и каким образом мы с этим работаем?</span></p>

<p><span>В платформе Ujin, как и в любом достаточно масштабном программном продукте, не обходится без сложностей как на этапе проектирования, так и на этапах разработки и эксплуатации. Особенно если кардинальным образом изменяются требования к базовым принципам, заложенным в архитектуру продукта.</span></p>

<p><span><strong>Одной из самых больших трудностей</strong>, с которыми нам пришлось столкнуться, стала не заложенная изначально в архитектуру платформы возможность горизонтального масштабирования. </span>Платформа не была рассчитана на многократный и быстрый рост нагрузки.<span> Причиной было монолитное ядро продукта, не поддерживающее возможности запустить его части на разных серверах либо запустить его части два и более раз параллельно для распределения нагрузки. </span></p>

<p><span>Для понимания приведу простую аналогию. У вас было задание построить легковой автомобиль, и вы с ним успешно справились. Но внезапно оказывается, что пассажиров в этом автомобиле больше ожидаемого числа, и на самом деле заказчику нужен был автобус. Затем оказывается, что, помимо пассажиров, вам нужно еще перевозить несколько грузовых контейнеров, и это скорее задача для тягача, нежели для легкового автомобиля. Напоследок вас предупреждают, что на следующей станции ожидается еще 40 человек и 3 прицепа.</span></p>

<p><span>Что же можно сделать в этой ситуации? Очевидный, казалось бы, вариант &mdash; начинать делать новую версию продукта с учетом полученного опыта и нового понимания целевого функционала. </span></p>

<p><span>Этот вариант оказался неприемлемым в силу целого ряда причин:</span></p>

<ul>
	<li><span>у текущего продукта есть большое количество заказчиков и пользователей, которых в любом случае требуется поддерживать, так как мы несем перед ними обязательства;</span></li>
	<li><span>заморозить развитие текущего продукта на время разработки новой версии невозможно;</span></li>
	<li><span>поступление новых требований заказчиков и партнеров будет приводить к тому, что один и тот же функционал придется разрабатывать для двух различных версий платформы, что негативно скажется на эффективности;</span></li>
	<li><span>существуют высокие риски, что новая версия продукта не сможет догнать текущую по функционалу, и пользователей невозможно будет перенести на новую версию с сохранением доступного им объема сервисов.</span></li>
</ul>

<p><span>Революционный путь не подошел, и потребовалось некое Соломоново решение, которое и было выработано. Была создана новая версия ядра платформы (Ujin v2), основанная на новой архитектуре, поддерживающей возможность масштабирования и географического распределения модулей платформы, что позволило более эффективно и гибко использовать аппаратные ресурсы, а также существенно повысило уровень отказоустойчивости решения в целом. Новая версия платформы способна все запросы к функционалу либо выполнять собственными силами, либо, если этот функционал на новой платформе еще не реализован, перенаправлять запросы на ядро старой платформы, а результат выполнения таким же образом возвращать пользователю. </span></p>

<p><span>Это позволило:</span></p>

<ul>
	<li><span>не терять функционал и обойтись без переноса данных;</span></li>
	<li><span>получить возможность внедрения принципиально новых архитектурных решений, несовместимых ранее с текущей версии платформы и тем самым решить ряд принципиальных проблем;</span></li>
	<li><span>получить возможность точечной переработки и оптимизации функционала с постепенным переносом его на новую версию платформы;</span></li>
	<li><span>получить возможность тестирования и отката на старую версию функционала, если в новой обнаружились недочеты;</span></li>
	<li><span>получить возможность масштабирования и более эффективного использования ресурсов (части ядра новой версии платформы могут быть запущены на множестве серверов);</span></li>
	<li><span>получить возможность реализации нового функционала сразу на новой версии платформы, что позволяет избежать дополнительных работ по дальнейшему переносу.</span></li>
</ul>

<p><span>Вернемся к аналогии с автомобилями. Пойдя по второму пути, мы построили платформу автопоезда, к которой в случае необходимости всегда можно добавить дополнительный тягач или прицеп, которая движется параллельным курсом и на которую постепенно переносят грузы и пассажиров, в то же время дорабатывая ее прямо на ходу.</span></p>

<p><span>Конечно, за все годы существования платформы было реализовано великое множество самого разного функционала, и процесс его переноса просто не может быть быстрым, но наиболее критичные сервисы и функционал уже перенесены. Главное &mdash; есть инструмент, который сделал это возможным.</span></p>

<p><span><strong>Вторая по значимости сложность</strong> &mdash; это использование &laquo;под капотом&raquo; платформы реляционной базы данных. В нашем случае используется PostgreSQL. И если для чтения из базы можно создать столько репликаций, сколько нужно, то с Master-сервером и записью сложнее. </span></p>

<p><span>Производительность любой базы данных постепенно снижается в зависимости от количества запросов, их специфики, объема обрабатываемых данных, и с какого-то момента сервер перестанет справляться с нагрузкой. </span></p>

<p><span>Для минимизации этих рисков специфические данные, работа с которыми генерировала б</span>о́<span>льшую часть нагрузки (например, сигналы устройств, push-уведомления, события) частично были вынесены в отдельные базы. Проблема уже не стоит остро.</span> Сегодня наша цель &mdash; снизить нагрузку на базу на 90%<span>, для чего производится переход на другие инструменты работы с данными, более подходящие для сигналов устройств и событий &mdash; Kafka, KeyDB, Prometheus, что в совокупности с сегментированием данных по различным базам позволит закрыть данный вопрос окончательно.</span></p>

<p><span><strong>Третья сложность</strong> заключается в большом количестве составных частей платформы. Данные &laquo;размазаны&raquo; в базе более чем по 1000 таблиц, и эти таблицы имеют явные и неявные логические связи между собой. </span></p>

<p><span>В хранилище около 250 репозиториев с кодом, которые также имеют перекрестные зависимости. Все это в целом не влияет на работу продукта, но усложняет его поддержку, увеличивает временные затраты на рефакторинг и внедрение нового функционала. </span></p>

<p><span>Сегодня уже составлен список репозиториев и таблиц, создан отдел технических писателей, проработана архитектура централизованного хранилища документации. Репозиторий каждой составляющей части продукта и каждая таблица будут последовательно должным образом описаны, снабжены номером версии, если это будет необходимо, и занесены в матрицу зависимостей. Нам еще предстоит написать дополнительные внутренние инструменты для контроля над этими зависимостями.</span></p>

<p><span>Решение этой проблемы также потребовало формирования и внедрения четких бизнес-процессов разработки продукта.</span></p>

<p><span><strong>Четвертая сложность</strong> &mdash; это необходимость использовать продукт как On-Premise решение, хотя изначально он проектировался как SaaS.</span></p>

<p><span>У нас уже был опыт запуска нашей платформы в отдельном изолированном окружении на мощностях заказчика. На тот момент мы не были в полной мере готовы к подобному запуску, поэтому не обошлось без сложных моментов. </span></p>

<p><span>Например, процесс создания чистой базы не был проработан полностью, и впоследствии в базе партнера мы находили &laquo;хвосты&raquo; данных других партнеров. Конечно, никаких персональных или иных критичных данных там не было, но, скажем, индексы нескольких сотен зданий, которых нет у партнера, или сигналы устройств, которые у него отсутствуют, или таблицы с данными для кастомного функционала, разработанного для других заказчиков, встречались постоянно. </span></p>

<p><span>Теперь же нам необходимо будет не только развернуть, но и одновременно поддерживать несколько экземпляров платформы. Для этого составлены списки обязательных и опциональных модулей платформы, сервисы контейнеризируются, пишутся инструменты, которые будут автоматизировать и облегчать пусконаладку отдельных экземпляров ПО. </span></p>

<p><span>Подводя итоги, можно сказать, что мы видим места, где нам еще требуется приложить усилия. Мы понимаем, что это не будет легко, как не может быть легкой разработка любого масштабного продукта. Но в 2022 году мы сделали очень многое, чтобы снизить риски и не закрыть себе возможности роста и развития. Уверен, что в 2023 году мы достигнем еще большего прогресса в отношении развития внутренней инфраструктуры и подходов к разработке.</span></p>


<p>Теги: <a href='tag_work.html'>work</a></p>
<!-- text end -->
<!-- entry end -->
</div>
<div id="disqus_thread"></div>
            <script type="text/javascript">
            /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
               var disqus_shortname = 'shumiloff'; // required: replace example with your forum shortname

            /* * * DONT EDIT BELOW THIS LINE * * */
            (function() {
            var dsq = document.createElement("script"); dsq.type = "text/javascript"; dsq.async = true;
            dsq.src = "//" + disqus_shortname + ".disqus.com/embed.js";
            (document.getElementsByTagName("head")[0] || document.getElementsByTagName("body")[0]).appendChild(dsq);
            })();
            </script>
            <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
            <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
<div id="footer">
<a href="https://vk.com/evgeniy_shumilov">Evgeniy Shumilov</a> &mdash; <a href="mailto:evgeniy&#46;shumilov&#64;gmail&#46;com">evgeniy&#46;shumilov&#64;gmail&#46;com</a><br/>
Generated with <a href="https://github.com/cfenollosa/bashblog">bashblog</a>, a single bash script to easily create blogs like this one</div>
</div></div>
</div></div>
<script type="text/javascript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'shumiloff'; // required: replace example with your forum shortname

        /* * * DONT EDIT BELOW THIS LINE * * */
        (function () {
        var s = document.createElement("script"); s.async = true;
        s.type = "text/javascript";
        s.src = "//" + disqus_shortname + ".disqus.com/count.js";
        (document.getElementsByTagName("HEAD")[0] || document.getElementsByTagName("BODY")[0]).appendChild(s);
    }());
    </script>
</body></html>
