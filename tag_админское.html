<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head>
<meta http-equiv="Content-type" content="text/html;charset=UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<link rel="stylesheet" href="main.css" type="text/css" />
<link rel="stylesheet" href="blog.css" type="text/css" />
<link rel="stylesheet" href="assets/highlight/styles/corpse.css" type="text/css" />
<link rel="alternate" type="application/rss+xml" title="" href="feed.rss" />
<link rel="shortcut icon" href="/images/favicon.ico" type="image/x-icon">
<link rel="icon" href="/images/favicon.ico" type="image/x-icon">
<script src="assets/jquery.min.js"></script>
<script src="assets/jouele/jouele.min.js"></script>
<link href="assets/jouele/jouele.min.css" rel="stylesheet"/>
<script src="assets/highlight/highlight.pack.js"></script>
<script>hljs.initHighlightingOnLoad();</script>
<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
   (function(m,e,t,r,i,k,a){m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};
   m[i].l=1*new Date();k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)})
   (window, document, "script", "https://mc.yandex.ru/metrika/tag.js", "ym");

   ym(52451890, "init", {
        id:52451890,
        clickmap:true,
        trackLinks:true,
        accurateTrackBounce:true
   });
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52451890" style="position:absolute; left:-9999px;" alt="" /></div></noscript>
<!-- /Yandex.Metrika counter -->
<title>Зайчатки разума &mdash; Теги: "админское"</title>
</head><body>
<div id="divbodyholder">
<div class="headerholder">
<a href="https://vk.com/evgeniy_shumilov" target="_blank"><img src="/images/logo.png" class="logo" height="106pt" style="float: left; margin-right: 20px;"></a>
<div class="header">
<div id="title">
<h1 class="nomargin"><a class="ablack" href="https://shumiloff.ru/index.html">Зайчатки разума</a></h1>
<div id="description">Записная книжка айтишника</div>
</div></div>
<ul class="full-width">
    <li>
        <a href="/pro-lyubov-k-minimalizmu-i-staticheskuyu-generaciyu-kontenta.html">О блоге</a>
<!--
        <ul>
            <li><a href="#">Item1</a></li>
            <li><a href="#">Item2</a></li>
            <li><a href="#">Item3</a></li>
        </ul>
-->
    </li>
    <li><a href="/all_tags.html">Теги</a></li>
    <li><a href="/all_posts.html">Все посты</a></li>
    <li><a href="/tag_ностальгия.html">Ностальгическое</a></li>
    <li><a href="/tag_мысли-вслух.html">Мысли вслух</a></li>
</ul>

<div class="ya-site-form ya-site-form_inited_no" onclick="return {'action':'https://yandex.ru/search/site/','arrow':false,'bg':'#b2b525','fontsize':12,'fg':'#000000','language':'ru','logo':'rw','publicname':'Поиск по shumiloff.ru','suggest':true,'target':'_self','tld':'ru','type':3,'usebigdictionary':true,'searchid':2336348,'input_fg':'#999999','input_bg':'#222222','input_fontStyle':'normal','input_fontWeight':'bold','input_placeholder':'Поиск живёт тут','input_placeholderColor':'#787A19','input_borderColor':'#999999'}"><form action="https://yandex.ru/search/site/" method="get" target="_self" accept-charset="utf-8"><input type="hidden" name="searchid" value="2336348"/><input type="hidden" name="l10n" value="ru"/><input type="hidden" name="reqenc" value=""/><input type="search" name="text" value=""/><input type="submit" value="Найти"/></form></div><style type="text/css">.ya-page_js_yes .ya-site-form_inited_no { display: none; }</style><script type="text/javascript">(function(w,d,c){var s=d.createElement('script'),h=d.getElementsByTagName('script')[0],e=d.documentElement;if((' '+e.className+' ').indexOf(' ya-page_js_yes ')===-1){e.className+=' ya-page_js_yes';}s.type='text/javascript';s.async=true;s.charset='utf-8';s.src=(d.location.protocol==='https:'?'https:':'http:')+'//site.yandex.net/v2.0/js/all.js';h.parentNode.insertBefore(s,h);(w[c]||(w[c]=[])).push(function(){Ya.Site.Form.init()})})(window,document,'yandex_site_callbacks');</script>
</div>
<div id="divbody"><div class="content">
<h3><a class="ablack" href="kontejner-pustyshka-dlya-overlayed-setej-docker-swarm.html">
Контейнер-пустышка для overlayed сетей docker swarm
</a></h3>
<!-- bashblog_timestamp: #201912102201.34# -->
<div class="subtitle">2019-12-10 22:01:34 &mdash; 
Evgeniy Shumilov
</div>
<!-- text begin -->

<p style="text-align:center"><img alt="" src="images/kostyl.jpg" /></p>

<p>&nbsp; В эфире рубрика &quot;Костыли и Велосипеды&quot;.</p>

<p>&nbsp; Не так давно добрались мои руки до docker swarm. Только не нужно напоминать о том, что docker на грани банкротства, а кубернетес правит миром окрестрации&nbsp; контейнеров. Подробно объяснять, что это такое, я не буду. И так достаточно много статей и <a href="https://docs.docker.com/engine/swarm/">документации</a> на эту тему. По сравнению с <a href="https://kubernetes.io/">kubernetes</a>, swarm намного легче и проще в обращении, не требует установки и практически не требует настройки и, что удобно, позволяет пользоваться почти теми же docker-compose файлами с минимальными изменениями для деплоя. Если контейнеров немного, то городить кластер на kubernetes не имеет смысла, swarm для этого вполне подойдёт.</p>

<p class="readmore"><a href="kontejner-pustyshka-dlya-overlayed-setej-docker-swarm.html">Читать дальше...</a></p>
<p>Теги: <a href='tag_админское.html'>админское</a>, <a href='tag_docker.html'>docker</a></p>
<h3><a class="ablack" href="o-pravilnoj-ostanovke-vneshnix-diskov-i-pobedivshej-kontejnerizacii.html">
О правильной остановке внешних дисков и победившей контейнеризации
</a></h3>
<!-- bashblog_timestamp: #201909060014.12# -->
<div class="subtitle">2019-09-06 00:14:12 &mdash; 
Evgeniy Shumilov
</div>
<!-- text begin -->

<p style="text-align:center"><img alt="" src="/images/usbhdd.jpg" /></p>

<p>&nbsp; Надо оставить тут заметку, чтобы не потерять. Возникла у меня проблема - накрылась в очередной раз от периодических отключений питания и отсутствия бесперебойника файловая система на домашнем сервере. Можно было конечно восстанавливать её работоспособность, но объективно было пора переходить на новую. Так как сервер в своё время стоял под телевизором и какое-то время выполнял роль ТВ приставки с Kodi и прочей мультимедией, то на сервере было много всего лишнего,&nbsp;поэтому&nbsp;наиболее идеологически верным было поставить всё с нуля и перенести лишь необходимое. До этого я пользовался <a href="http:///okna-v-okne---pro-evolyuciyu-virtualizacii.html" target="_blank">proxmox</a>, но уже давно мне не нужны были честные виртуальные машины (а когда они будут нужны, проще на рабочей машине поднять виртуалку в VirtualBox), а все необходимые мне сервисы&nbsp;я давно перенёс в докер.&nbsp;</p>

<p class="readmore"><a href="o-pravilnoj-ostanovke-vneshnix-diskov-i-pobedivshej-kontejnerizacii.html">Читать дальше...</a></p>
<p>Теги: <a href='tag_админское.html'>админское</a>, <a href='tag_docker.html'>docker</a>, <a href='tag_hardware.html'>hardware</a>, <a href='tag_linux.html'>linux</a>, <a href='tag_soft.html'>soft</a></p>
<h3><a class="ablack" href="nbspkak-umenshit-razmer-kontejnera-s-python-proektom.html">
Как уменьшить размер контейнера с python проектом
</a></h3>
<!-- bashblog_timestamp: #201905301859.31# -->
<div class="subtitle">2019-05-30 18:59:31 &mdash; 
Evgeniy Shumilov
</div>
<!-- text begin -->

<p style="text-align:center"><img alt="" src="/images/docker-python.png" /></p>

<p>&nbsp; Для многих небольших микросервисов и проектов я использую python. В то же время контейнеры с python внутри не отличаются компактностью. Сегодня на примере одного проекта попробую проиллюстрировать, как избавить контейнер от лишнего веса.</p>

<p class="readmore"><a href="nbspkak-umenshit-razmer-kontejnera-s-python-proektom.html">Читать дальше...</a></p>
<p>Теги: <a href='tag_админское.html'>админское</a>, <a href='tag_containers.html'>containers</a>, <a href='tag_docker.html'>docker</a>, <a href='tag_python.html'>python</a></p>
<h3><a class="ablack" href="ustanovka-ansistrano-na-debian-i-reshenie-problem.html">
Установка Ansistrano на Debian и решение проблем
</a></h3>
<!-- bashblog_timestamp: #201905281803.06# -->
<div class="subtitle">2019-05-28 18:03:06 &mdash; 
Evgeniy Shumilov
</div>
<!-- text begin -->

<p style="text-align:center"><img alt="" src="/images/ansible-debian.png" /></p>

<p>&nbsp; Не так давно появилась необходимость реализовать CI/CD. Подумав, решил разбить это на две части - сборку и деплой контейнеров и отдельно - на деплой кода. Вторую часть решил реализовать с помощью <a href="https://github.com/ansistrano" target="_blank">ansistrano</a> - это аналог <a href="https://capistranorb.com/" target="_blank">capistrano</a>, только выполненный в виде модуля для <a href="https://ru.wikipedia.org/wiki/Ansible" target="_blank">ansible</a>. Почему не стал делать статические контейнеры с кодом? Хотя бы потому, что в случае использования ansistrano, роллбек проходит практически мгновенно, а это большой плюс. Когда-то я уже поднимал ansistrano, но на этот раз всё оказалось несколько сложнее.</p>

<p class="readmore"><a href="ustanovka-ansistrano-na-debian-i-reshenie-problem.html">Читать дальше...</a></p>
<p>Теги: <a href='tag_админское.html'>админское</a>, <a href='tag_ansible.html'>ansible</a></p>
<h3><a class="ablack" href="pravilnoe-otklyuchenie-swap-razdela-v-linux-mint.html">
Правильное отключение SWAP раздела в Linux Mint
</a></h3>
<!-- bashblog_timestamp: #201904040220.12# -->
<div class="subtitle">2019-04-04 02:20:12 &mdash; 
Evgeniy Shumilov
</div>
<!-- text begin -->
<p style="text-align: center;"><img src="images/swap.jpg"></p>
<p>&nbsp; До того, как я <a href="muka-vybora-noutbuka.html" target="_blank">купил себе ноутбук</a>, я предварительно искал информацию о том, с какими проблемами&nbsp;мне придётся&nbsp;столкнуться при установке линукса. Судя по тому, что я нашёл, мне светило пропатчить модуль ядра для того, чтобы заработал тачпад и собрать модуль драйвера Wi-Fi из исходников.&nbsp;Это конечно, совершенно не rocket science, но со временем начинаешь ценить время и удобство, хочется побольше вещей, которые просто работают, работают хорошо и из коробки.</p>
<p>&nbsp; Последние лет шесть я работал на самосборном дистрибутиве на базе debian. И всё было бы ничего, но поддержка этого дистрибутива в актуальном состоянии требовала периодических усилий и существенных затрат времени. Так как debian stable имеет далеко не самую свежую пакетную базу, то заморочек с железом ожидалось больше, чем обычно. Так как у меня уже был <a href="pingvin-s-chelovecheskim-licom.html" target="_blank">положительный опыт установки Linux Mint</a>, я взял <a href="https://blog.linuxmint.com/?p=3671" target="_blank">последнюю версию 19.1 Tara с xfce4</a>,&nbsp;накатил на ноутбук и - о чудо - всё заработало. Абсолютно всё - тачпад, звук, wi-fi, видео. При всём этом установка заняла в общей сложности всего минут&nbsp;пять.&nbsp;</p>
<p class="readmore"><a href="pravilnoe-otklyuchenie-swap-razdela-v-linux-mint.html">Читать дальше...</a></p>
<p>Теги: <a href='tag_linux.html'>linux</a>, <a href='tag_админское.html'>админское</a></p>
<h3><a class="ablack" href="skript-dlya-proverki-vremeni-protuxaniya-sertifikatov.html">
Скрипт для проверки времени протухания сертификатов
</a></h3>
<!-- bashblog_timestamp: #201903210204.17# -->
<div class="subtitle">2019-03-21 02:04:17 &mdash; 
Evgeniy Shumilov
</div>
<!-- text begin -->
<p style="text-align: center;"><img src="images/escheckcert.png"></p>
<p>&nbsp; На работе понадобилось отслеживать время протухания различных сертификатов и слать алерты в случае, если до истечения осталось менее, чем N дней. Быстро накидал скрипт, а потом решил&nbsp;расширить его функционал таким образом, чтобы он сам находил все сертификаты в директории и выдавал даты выдачи и истечения срока действия сертификата, время жизни и количество дней, в течение которых сертификат остаётся валидным. В случае, если хотя бы один из сертификатов оказывается невалидным, возвращается ненулевой код&nbsp;возврата, в результате чего можно удобно использовать скрипт для отправки алертов.</p>
<pre><code class="bash">if! expired=`./escheckcert.sh domain1.com domain2.com`; then
  echo "$expired" | mail -s "Expired certs" admin@domain.com
fi</code></pre>
<p>&nbsp; Так же можно помимо файлов сертификатов и путей директорий, содержащих сертификаты, использовать непосредственно доменные имена.&nbsp;Имена файлов, директорий и доменов можно передавать скрипту вперемешку, разделяя пробелами.&nbsp;</p>
<p>&nbsp; Причесал код, <a href="https://github.com/alive-corpse/escheckcert" target="_blank">выложил на github</a>, доволен.&nbsp;И на работе задачу выполнил и для себя давно подобную утилиту хотел и пост в блог получился.</p>

<p>Теги: <a href='tag_shell.html'>shell</a>, <a href='tag_админское.html'>админское</a></p>

<!-- text end -->
<h3><a class="ablack" href="pro-byurokratiyu-doxlyx-myshej-inventarizadnicu-i-adminskuyu-magiyu.html">
Про бюрократию, дохлых мышей, инвентаризадницу и админскую магию
</a></h3>
<!-- bashblog_timestamp: #201903132139.24# -->
<div class="subtitle">2019-03-13 21:39:24 &mdash; 
Evgeniy Shumilov
</div>
<!-- text begin -->
<p style="text-align: center;"><img src="images/burocrat.jpg"></p>
<p><span style="font-weight: 400;">&nbsp; Внезапно вспомнился период мой работы в конторе под названием КЭС-Прикамье, это было примерно лет десять тому назад и это была одна из самых бюрократических контор, которые мне удалось повидать в своей жизни. Одним из самых ярких примеров бюрократии была процедура заказа оборудования. Например, у Ивана Ивановича на рабочем месте сдохла компьютерная мышь. Далее начинается целый процесс, в который вовлечено множество людей и который влечёт за собой километры, набеганные по коридору.</span></p>
<p class="readmore"><a href="pro-byurokratiyu-doxlyx-myshej-inventarizadnicu-i-adminskuyu-magiyu.html">Читать дальше...</a></p>
<p>Теги: <a href='tag_админское.html'>админское</a>, <a href='tag_fun.html'>fun</a></p>
<h3><a class="ablack" href="ochistka-staryx-smerzhennyx-vetok-v-udalyonnom-git-repozitorii.html">
Очистка старых смерженных веток в удалённом git репозитории
</a></h3>
<!-- bashblog_timestamp: #201903012048.21# -->
<div class="subtitle">2019-03-01 20:48:21 &mdash; 
Evgeniy Shumilov
</div>
<!-- text begin -->
<p style="text-align: center;"><img src="images/gitclean.png"></p>
<p>&nbsp; Не так давно по работе я столкнулся с задачей - необходимо было очистить большой репозиторий на гитхабе от всех веток, которые были полностью смержены в мастер, позднее, чем N дней.&nbsp;Для этого пришлось написать небольшой скрипт, который я просто оставлю ниже.</p>
<p class="readmore"><a href="ochistka-staryx-smerzhennyx-vetok-v-udalyonnom-git-repozitorii.html">Читать дальше...</a></p>
<p>Теги: <a href='tag_админское.html'>админское</a>, <a href='tag_shell.html'>shell</a>, <a href='tag_automatization.html'>automatization</a></p>
<h3><a class="ablack" href="ochistka-staroj-pochty-v-gmail.html">
Очистка старой почты в gmail
</a></h3>
<!-- bashblog_timestamp: #201902121714.56# -->
<div class="subtitle">2019-02-12 17:14:56 &mdash; 
Evgeniy Shumilov
</div>
<!-- text begin -->
<p style="text-align: center;"><img src="images/gmail/logo.png"></p>
<p>&nbsp; Раз в пару лет я провожу генеральную уборку в своём почтовом ящике. Так как пользуюсь я gmail аккаунтом, то веб-интерфейс для этого, как выяснилось уже давно, далеко не самое удобное решение. Конечно, у меня уже прописан миллион правил для писем, на основании которых письма сортируются по папкам, но и этого зачастую не хватает. Появляются новые письма, которые не попадают под уже существующие метки и за год таких писем может накопиться скажем, пара миллионов. Более того, есть письма, которые мне нужны в определённой папке какое-то время, например, месяц или два и которые затем можно смело удалить. Так вот, в рамках самого&nbsp;gmail, насколько я понимаю, нет возможности настроить правило с соответствующим функционалом,&nbsp;но есть в принципе несколько методов борьбы с данной проблемой.</p>
<p class="readmore"><a href="ochistka-staroj-pochty-v-gmail.html">Читать дальше...</a></p>
<p>Теги: <a href='tag_админское.html'>админское</a></p>
<h3><a class="ablack" href="skript-dlya-obnovleniya-dns-zapisej-cloudflare.html">
Скрипт для обновления DNS записей CloudFlare
</a></h3>
<!-- bashblog_timestamp: #201902070340.17# -->
<div class="subtitle">2019-02-07 03:40:17 &mdash; 
Evgeniy Shumilov
</div>
<!-- text begin -->

<p style="text-align: center;"><img src="images/escflare.png"></p>
<p>&nbsp; Пост называется "опять не спится" или "как&nbsp;бесплатно&nbsp;завернуть домен второго уровня на ваш домашний динамический IP адрес". Для чего это вам может быть нужно? Вариантов много. Например, это возможность впоследствии поднять дома какие-нибудь сервисы. Например, создать <a href="https://nextcloud.com/" target="_blank">собственное облако для хранения и расшаривания файлов</a> и смотреть в пути фильмы, лежащие на домашнем жёстком диске или развернуть <a href="http://max-3000.com/" target="_blank">личный блог</a>, сайт-визитку, <a href="https://mjdm.ru/" target="_blank">сервис умного дома</a>, да хоть устроить <a href="https://www.dmosk.ru/instruktions.php?object=Icecast" target="_blank">станцию онлайн вещания</a> - всё ограничивается вашей фантазией, вариантов использования может найтись масса, когда существует возможность.</p>
<p class="readmore"><a href="skript-dlya-obnovleniya-dns-zapisej-cloudflare.html">Читать дальше...</a></p>
<p>Теги: <a href='tag_shell.html'>shell</a>, <a href='tag_automatization.html'>automatization</a>, <a href='tag_networking.html'>networking</a>, <a href='tag_админское.html'>админское</a></p>
<h3><a class="ablack" href="pro-vnezapnyj-pereezd-na-github-pages.html">
Про внезапный переезд на GitHub Pages
</a></h3>
<!-- bashblog_timestamp: #201901301406.59# -->
<div class="subtitle">2019-01-30 14:06:59 &mdash; 
Evgeniy Shumilov
</div>
<!-- text begin -->

<p style="text-align: center;"><img src="images/ghpageslogo.png"></p>
<p>&nbsp; Сегодня ночью случилось сразу несколько событий. Яндекс мигрировал мой домен в <a href="https://connect.yandex.ru/" target="_blank">Яндекс.Коннект</a>, у меня дома отвалился интернет, а затем выключили и электропитание. Нередкий случай проявления заботы со стороны нашего ТСЖ - нечего ночами сидеть в сети, ложись спать давай, родной. Вот, мы и свет уже тебе погасили. Логичным продолжением было бы отключение воды, отопления, газа и, чего уж там, сразу воздуха, но этого, что меня радует, не последовало.</p>
<p>&nbsp; Через какое-то время мой хороший друг написал в телеграм - мол, блог твой недоступен, на что ласково был обозван "мониторингом мониторинговичем" и примерно в этот же миг снизошло на меня озарение свыше - включили свет и увидел я мир вокруг. И понял я, что это хорошо. Интернет тоже не заставил себя ждать, а вот блог так и остался недоступен. Раньше я бы плюнул на всё и лёг спать, но с мыслью о 52х постах, которые кто-то читает, кто-то даже комментирует, а кому-то, о чудо, и вовсе нравится, я уже уснуть спокойно не мог. Надо было чинить.</p>
<p class="readmore"><a href="pro-vnezapnyj-pereezd-na-github-pages.html">Читать дальше...</a></p>
<p>Теги: <a href='tag_blog.html'>blog</a>, <a href='tag_админское.html'>админское</a></p>
<h3><a class="ablack" href="pro-optimizaciyu-tishinu-evolyuciyu-nestandartnye-resheniya-i-domashnyuyu-set.html">
Про оптимизацию, тишину, эволюцию, нестандартные решения и домашнюю сеть.
</a></h3>
<!-- bashblog_timestamp: #201901210115.09# -->
<div class="subtitle">2019-01-21 01:15:09 &mdash; 
Evgeniy Shumilov
</div>
<!-- text begin -->

<p style="text-align: center;"><img src="images/balcon/1.jpg" /></p>
<p>&nbsp; Достаточно давно я собрал свой первый домашний сервер. И довольно много сил я тогда положил на то, чтобы сделать его как можно более&nbsp;тихим, маленьким и потребляющим минимум энергии. Я сменил радиаторы на процессеоре и северном мосту с целью увеличить площадь рассеивающей поверхности. Я искал самые тихие кулеры, я занижал частоту процессора, я сменил кулер в блоке питания и жёсткий диск я выбирал тоже исходя из теж же требований - тихий и потребляющий минимум энергии. В конце-концов, я <a href="/kunstkamera-drevesnostruzhechnoj-promyshlennosti-ili-mdf-neadekvatnost.html" target="_blank">переместил свой сервер в диван</a>. Мне тогда нужна была платформа для экспериментов и само-собою подразумевалось, что она будет работать 24 часа, 7 дней в неделю.</p>
<p>&nbsp; Зачем <span style="text-decoration: line-through;">не</span>нормальному человеку может быть нужен сервер? Во-первых, это файлопомойка; во-вторых, это медиакомбайн, соединённый с музыкальным центром и имеющий доступ ко всем твоим аудиозаписям, а заодно и к нескольким десяткам онлайн радиостанций; в-третьих файрвол, позволяющий тонко управлять различными подключениями и роутингом между двумя провайдерами и рабочей сетью; в-четвёртых - VPN; в пятых... Продолжать можно долго.</p>
<p class="readmore"><a href="pro-optimizaciyu-tishinu-evolyuciyu-nestandartnye-resheniya-i-domashnyuyu-set.html">Читать дальше...</a></p>
<p>Теги: <a href='tag_админское.html'>админское</a>, <a href='tag_automatization.html'>automatization</a>, <a href='tag_networking.html'>networking</a>, <a href='tag_python.html'>python</a></p>
<h3><a class="ablack" href="otpravka-logov-s-openwrtlede-v-syslog-i-obrabotka-sobytij.html">
Отправка логов с OpenWRT/LEDE в syslog и обработка событий
</a></h3>
<!-- bashblog_timestamp: #201901130231.22# -->
<div class="subtitle">2019-01-13 02:31:22 &mdash; 
Evgeniy Shumilov
</div>
<!-- text begin -->
<p>&nbsp; <img src="/images/syslog/syslogng.png" class="leftimg">Вдогонку к <a href="/pro-centralizovannyj-sbor-logov.html" target="_blank">статье о syslog-ng</a> решил сделать дополнение о том, как завернуть логи с OpenWRT и настроить реакцию на соответствие какому-нибудь фильтру. Дома у меня есть два Xiaomi MiWifi 3G (оказалось крайне доступным и достойным по характеристикам устройством), три штуки Netgear WNR3500L, которые в текущий момент работают в качестве гигабитных свичей в разных частях квартиры и Nexx 3020 для экспериментов. Одним словом, правило для сохранения логов должно быть общее для всех этих устройств, чтобы не писать шесть отдельных конфигурационных файлов. Начать я решил со своего основного Xiaomi роутера с хостнеймом gw01, на котором стоит <a href="https://openwrt.org/releases/18.06/start" target="_blank">OpenWRT 18.06</a>.</p>
<p class="readmore"><a href="otpravka-logov-s-openwrtlede-v-syslog-i-obrabotka-sobytij.html">Читать дальше...</a></p>
<p>Теги: <a href='tag_админское.html'>админское</a>, <a href='tag_docker.html'>docker</a>, <a href='tag_logging.html'>logging</a></p>
<h3><a class="ablack" href="pro-centralizovannyj-sbor-logov.html">
Про централизованный сбор логов
</a></h3>
<!-- bashblog_timestamp: #201901030052.53# -->
<div class="subtitle">2019-01-03 00:52:53 &mdash; 
Evgeniy Shumilov
</div>
<!-- text begin -->

<p style="text-align: center;"><img src="images/syslog/syslogng.png"></p>
<p>&nbsp; За последнее время случилось несколько событий, которые привели меня к необходимости централизованного сбора логов в своей домашней сети.</p>
<h4>Что и зачем собирать?</h4>
<ol>
<li>Периодически ночью отваливается интернет от билайна, хотелось бы видеть, что в этот момент происходит с роутером.</li>
<li>Есть десяток IoT устройств, построенных на ESP8266, которые с прошивкой ESPEasy умеют отправлять логи по сети.</li>
<li>Жена на новый год подарила управляемый гигабитный коммутатор, почему бы не снимать логи и с него, если уж будет такая возможность?</li>
<li>Есть сервер умного дома, работающий на отдельной OrangePI Zero.</li>
<li>Есть около полутора десятков докер и lxc контейнеров с различными службами и pet-проектами, в том числе и этот блог.</li>
</ol>
<p>&nbsp; Хотелось бы хранить все эти логи в одном месте, чтобы облегчить их анализ, ротацию, архивирование и бекап. Как обрабатывать подобную информацию - это уже отдельная задача, но для начала эту информацию нужно собрать.</p>
<p class="readmore"><a href="pro-centralizovannyj-sbor-logov.html">Читать дальше...</a></p>
<p>Теги: <a href='tag_админское.html'>админское</a>, <a href='tag_docker.html'>docker</a>, <a href='tag_logging.html'>logging</a></p>
<h3><a class="ablack" href="gde-mogut-prigoditsya-grafiki.html">
Где могут пригодиться графики
</a></h3>
<!-- bashblog_timestamp: #201811212304.05# -->
<div class="subtitle">2018-11-21 23:04:05 &mdash; 
Evgeniy Shumilov
</div>
<!-- text begin -->

<p style="text-align: center;"><img src="/images/gr1.png"></p>
<p>&nbsp; Пару месяцев назад я нашёл для себя неожиданно полезное применение графиков в своей работе. И нет, это не мониторинг в классическом понимании этого слова. Это наколенные прогнозы.</p>
<h4>Описание задачи</h4>
<p>&nbsp; Есть у нас в jenkins одна джоба, которая производит довольно длительную операцию с базой данных. Размер базы около 100Гб, самый долгий этап - обработка таблицы почти в 60 миллионов записей. Иногда этот процесс проходил за 7 часов, иногда за 21 час и я пытался обнаружить причину, по которой получается такая разница во времени обработки данных. Проблема была в том, что понять, насколько быстро выполняется очередная ревизия джобы из километрового лога с цифрами было достаточно сложно. Скрипт раз в 30 секунд выдавал количество обработанных строк и приходилось брать разницу в этом количестве на каком-то временном периоде и затем сравнивать её с аналогичным прошлым, позапрошлым и, возможно, поза-поза-чёрт-знает-сколько-прошлым запуском. Ведь нет смысла ждать и нагружать мощности, если за час работы скрипта можно определить, сколько примерно он будет работать. Но всё оказалось не так просто. Зависимость количества обработанных строк за единицу времени оказалась нелинейной и чтобы понять характер работы, мне понадобился график.</p>
<p class="readmore"><a href="gde-mogut-prigoditsya-grafiki.html">Читать дальше...</a></p>
<p>Теги: <a href='tag_shell.html'>shell</a>, <a href='tag_админское.html'>админское</a>, <a href='tag_aws.html'>aws</a></p>
<h3><a class="ablack" href="ready-for-production.html">
Ready for production
</a></h3>
<!-- bashblog_timestamp: #201811132242.34# -->
<div class="subtitle">2018-11-13 22:42:34 &mdash; 
Evgeniy Shumilov
</div>
<!-- text begin -->

<h1 style="text-align: center;">- Ты видишь контейнер?</h1>
<h1 style="text-align: center;">- Вижу.</h1>
<p style="text-align: center;"><img src="images/shredinger.jpg"></p>
<h1 style="text-align: center;">- И я вижу. А его нет!</h1>
<p>&nbsp; Достаточно давно я заметил где-то фразу о том, что "docker is ready for production". С тех пор периодически вспоминаю её, каждый раз, когда сталкиваюсь с какими-либо проблемами разного масштаба, связанными с докером. Не поймите меня неправильно, мне нравится эта технология, но для меня странным остаётся тот набор детских заболеваний, которыми этот продукт страдает во вполне зрелом возрасте. Так же не понимаю этого дикого ажиотажа вокруг именно докера, когда всё что нужно и не нужно, пытаются затолкнуть в контейнер, не взирая на то, насколько это удобно и целесообразно в текущей ситуации. Создаётся впечатление, что во-первых, раньше не было никакой контейнеризации в принципе - ни jails на BSD, ни <a href="https://openvz.org/" target="_blank">OpenVZ</a>&nbsp;и <a href="https://linuxcontainers.org/lxc/introduction/" target="_blank">LXC</a> на линуксе, а во-вторых - и сейчас нет никаких иных технологий, кроме докера - ни <a href="https://snapcraft.io/" target="_blank">snap</a>/<a href="https://flatpak.org/" target="_blank">flatpack</a> (да-да, иксовые приложения для десктопа тоже пытаются завернуть в докер), ни virtualenv для пайтона - ничего подобного, ни пакетов, ни средств вроде puppet/ansible. Конечно, у докера есть удобные средства доставки, с этим никто не спорит, но не понятно, почему выстрелил в своё время именно он, что его сделало таким "модным, стильным, молодёжным". Скажем, OpenVZ мне нравился откровенно больше, чем LXC, но и тем и другим я пользовался задолго до того, как появился докер. Что помешало обрасти средствами доставки и прочими плюшечками тому же OpenVZ? Отсутствие нативной поддержки в ядре?</p>
<p class="readmore"><a href="ready-for-production.html">Читать дальше...</a></p>
<p>Теги: <a href='tag_docker.html'>docker</a>, <a href='tag_админское.html'>админское</a></p>
<h3><a class="ablack" href="malysham-o-mineralax.html">
Малышам о минералах
</a></h3>
<!-- bashblog_timestamp: #201811092212.03# -->
<div class="subtitle">2018-11-09 22:12:03 &mdash; 
Evgeniy Shumilov
</div>
<!-- text begin -->

<img src="images/ruby-logo.png" width="200px" height="175px" class="leftimg">
<p>&nbsp; Так называлась одна из любимых книг моего детства. После неё я ещё несколько лет собирал по песочницам разные камни, коих у меня была целая коллекция. Она, как и многое другое, благополучно канула в лету. Но это так, лирическое отступление.</p>
<p class="light">&nbsp; У нас было две версии руби из репозитория, 75 гемм, 2 версии thin сервера, ящик циклических зависимостей, пара попыток поставить отдельный environment и куча разных конфигов всех сортов и расцветок. Не то, чтобы этого было достаточно для того, чтобы поднять проект, но если связался с руби, уже трудно остановиться. Единственное, что вызывает у меня опасения - это пакеты из стока дистрибутива. Нет ничего более беспомощного, безответственного и испорченного, чем руби окружение, поставленное из стока, с установленными поверх геммами. Я знал, что рано или поздно мы перейдём на эту дрянь.</p>
<p>&nbsp; Примерно так год назад выглядел мой отчёт начальнику на его вопрос - "как там у нас с переездом редмайна на свежее окружение?"</p>
<p class="readmore"><a href="malysham-o-mineralax.html">Читать дальше...</a></p>
<p>Теги: <a href='tag_ruby.html'>ruby</a>, <a href='tag_админское.html'>админское</a>, <a href='tag_fun.html'>fun</a></p>
<h3><a class="ablack" href="sam-sebe-xosting-ili-o-nedoocenyonnyx-utilitax.html">
Сам себе хостинг или о недооценённых утилитах
</a></h3>
<!-- bashblog_timestamp: #201810210049.04# -->
<div class="subtitle">2018-10-21 00:49:04 &mdash; 
Evgeniy Shumilov
</div>
<!-- text begin -->

<i>- Та-ак, а вы что, ещё и права на файлы за меня выдавать будете?<br/>
- Ага-а-а!</i>
<br/>
<img src="/images/mss.png" class="rightimg">
<p>&nbsp;&nbsp;О чём вы думаете, когда слышите аббревиатуру FTP? На меня накатывает ностальгия. Сразу вспоминаются всякие уютные ламповые локалочки, сетевые карты rtl8139, серенькие восьмипортовые коммутаторы D-Link в пластиковых корпусах, папки Public и Private, полные варезом - фильмы, музыка, софт, игры... Одним словом, машинка времени в моей голове телепортирует меня куда-то лет на 15 назад. Много воды утекло с тех пор, но когда кто-то просит совета, как построить себе миниатюрный хостинг, часто в числе прочего я в том или ином виде получаю вопрос: "как поднять FTP"? И каждый раз меня это удивляет. А чем sftp не угодил? Да, это медленнее, но во-первых, скорость интернет соединения сейчас уже не та, что была 15 лет тому, во-вторых, у sftp на борту шифрование и в-третьих, sftp практически всегда уже есть там, где присутствует openssh.</p>
<p>&nbsp;&nbsp;Да, sftp, реализованный средствами OpenSSH не лишён ряда недостатков. Хотелось найти некое решение, которое бы позволило быстро и просто реализовать доступ к машине для разных пользователей, для каждого в свою папку, желательно с chroot. Всё заканчивалось длинными ролями на ансибле, которые переписывали конфиги openssh, добавляли пользователей в нужные гргуппы, ставили пакет управления расширенными правами доступа, дёргали всякие setfacl и прочее. И тут меня попросил мой хороший друг (Иван, спасибо тебе!) помочь ему настроить сервер, а пользователям в качестве шелла поставить MySecureShell. Ранее я с таким зверем не сталкивался, да и ни от кого из моих знакомых за те почти 15 лет, что я общаюсь с linux, не слышал. Судя по всему, это не особо популярное решение. Я бы сказал, незаслуженно обойдённое вниманием. Да вы только посмотрите на их логотип! Похоже, это пингвин, прямо поверх которого начали разводить печатную плату (что похоже, сказалось на его настроении), при этом он ещё кому-то угражает двумя логотипами OpenBSD! Интересно, на каких веществах сидел автор? Ладно, этот вопрос оставим наркологам. Лучше посмотрим в конфигурационный файл. Почитав, что там написано, я понял, что эта штука умеет всё, о чём я мечтал и многое из того, о чём я мечтать не смел.</p>
<p class="readmore"><a href="sam-sebe-xosting-ili-o-nedoocenyonnyx-utilitax.html">Читать дальше...</a></p>
<p>Теги: <a href='tag_ssh.html'>ssh</a>, <a href='tag_shell.html'>shell</a>, <a href='tag_sftp.html'>sftp</a>, <a href='tag_админское.html'>админское</a></p>
<h3><a class="ablack" href="nemnogo-ob-avtomaticheskoj-generacii-parolej.html">
Немного об автоматической генерации паролей
</a></h3>
<!-- bashblog_timestamp: #201810191505.32# -->
<div class="subtitle">2018-10-19 15:05:32 &mdash; 
Evgeniy Shumilov
</div>
<!-- text begin -->

<p>&nbsp;&nbsp;Зачастую возникает необходимость сгенерировать для какой-то цели пароль. Преимущественно это пароль, состоящий из некоторого количества цифр и букв разного регистра.Иногда требуется сгенерировать несколько паролей сразу. Например, для обновления паролей для целой группы пользователей в скрипте или просто хочется выбрать наиболее удобный для набора. Пересмотрев несколько решений, я решил снова ездить на своих велосипедах, так как они имеют минимум зависимостей.</p>
<p class="readmore"><a href="nemnogo-ob-avtomaticheskoj-generacii-parolej.html">Читать дальше...</a></p>
<p>Теги: <a href='tag_shell.html'>shell</a>, <a href='tag_automatization.html'>automatization</a>, <a href='tag_админское.html'>админское</a></p>
<h3><a class="ablack" href="aspekty-nastrojki-seti-v-qemu-obedinenie-interfejsov-na-kanalnom-urovne.html">
АСПЕКТЫ НАСТРОЙКИ СЕТИ В QEMU. ОБЪЕДИНЕНИЕ ИНТЕРФЕЙСОВ НА КАНАЛЬНОМ УРОВНЕ.
</a></h3>
<!-- bashblog_timestamp: #201810162150.30# -->
<div class="subtitle">2018-10-16 21:50:30 &mdash; 
Evgeniy Shumilov
</div>
<!-- text begin -->

<p class="light">Это репост статьи от новогодней ночи 31 декабря 2008г. - 1 января 2009г.</p>

<p>&nbsp;&nbsp;Доброго времени суток. Вечер. 31 декабря 2008 года. Чем заняться человеку в такое время? Правильно! Начать писать статью на permlug, чтобы поделиться опытом. :)</p>

<p class="readmore"><a href="aspekty-nastrojki-seti-v-qemu-obedinenie-interfejsov-na-kanalnom-urovne.html">Читать дальше...</a></p>
<p>Теги: <a href='tag_virtualization.html'>virtualization</a>, <a href='tag_qemu.html'>qemu</a>, <a href='tag_networking.html'>networking</a>, <a href='tag_админское.html'>админское</a></p>
</div>
<div id="footer">
<!-- Tolstoy Comments
<script type="text/javascript">!(function(w,d,s,l,x){w[l]=w[l]||[];var f=d.getElementsByTagName(s)[0],j=d.createElement(s);j.async=!0;j.src='//web.tolstoycomments.com/sitejs/app.js?i='+l+'&x='+x+'&t='+(new Date().getTime());f.parentNode.insertBefore(j,f)})(window,document,'script','tolstoycomments','1577');</script>
-->
<a href="https://vk.com/evgeniy_shumilov">Evgeniy Shumilov</a> &mdash; <a href="mailto:evgeniy&#46;shumilov&#64;gmail&#46;com">evgeniy&#46;shumilov&#64;gmail&#46;com</a><br/>
Generated with <a href="https://github.com/cfenollosa/bashblog">bashblog</a>, a single bash script to easily create blogs like this one</div>
</div></div>
</div></div>
</body></html>
