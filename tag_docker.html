<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head>
<meta http-equiv="Content-type" content="text/html;charset=UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<link rel="stylesheet" href="main.css" type="text/css" />
<link rel="stylesheet" href="blog.css" type="text/css" />
<link rel="stylesheet" href="assets/highlight/styles/corpse.css" type="text/css" />
<link rel="alternate" type="application/rss+xml" title="" href="feed.rss" />
<link rel="shortcut icon" href="/images/favicon.ico" type="image/x-icon">
<link rel="icon" href="/images/favicon.ico" type="image/x-icon">
<script src="assets/jquery.min.js"></script>
<script src="assets/jouele/jouele.min.js"></script>
<link href="assets/jouele/jouele.min.css" rel="stylesheet"/>
<script src="assets/highlight/highlight.pack.js"></script>
<script>hljs.initHighlightingOnLoad();</script>
<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
   (function(m,e,t,r,i,k,a){m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};
   m[i].l=1*new Date();k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)})
   (window, document, "script", "https://mc.yandex.ru/metrika/tag.js", "ym");

   ym(52451890, "init", {
        id:52451890,
        clickmap:true,
        trackLinks:true,
        accurateTrackBounce:true
   });
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52451890" style="position:absolute; left:-9999px;" alt="" /></div></noscript>
<!-- /Yandex.Metrika counter -->
<title>Зайчатки разума &mdash; Теги: "docker"</title>
</head><body>
<div id="divbodyholder">
<div class="headerholder">
<a href="https://vk.com/evgeniy_shumilov" target="_blank"><img src="/images/logo.png" class="logo" height="106pt" style="float: left; margin-right: 20px;"></a>
<div class="header">
<div id="title">
<h1 class="nomargin"><a class="ablack" href="https://shumiloff.ru/index.html">Зайчатки разума</a></h1>
<div id="description">Записная книжка айтишника</div>
</div></div>
<ul class="full-width">
    <li>
        <a href="/pro-lyubov-k-minimalizmu-i-staticheskuyu-generaciyu-kontenta.html">О блоге</a>
<!--
        <ul>
            <li><a href="#">Item1</a></li>
            <li><a href="#">Item2</a></li>
            <li><a href="#">Item3</a></li>
        </ul>
-->
    </li>
    <li><a href="/all_tags.html">Теги</a></li>
    <li><a href="/all_posts.html">Все посты</a></li>
    <li><a href="/tag_ностальгия.html">Ностальгическое</a></li>
    <li><a href="/tag_мысли-вслух.html">Мысли вслух</a></li>
</ul>

<div class="ya-site-form ya-site-form_inited_no" onclick="return {'action':'https://yandex.ru/search/site/','arrow':false,'bg':'#b2b525','fontsize':12,'fg':'#000000','language':'ru','logo':'rw','publicname':'Поиск по shumiloff.ru','suggest':true,'target':'_self','tld':'ru','type':3,'usebigdictionary':true,'searchid':2336348,'input_fg':'#999999','input_bg':'#222222','input_fontStyle':'normal','input_fontWeight':'bold','input_placeholder':'Поиск живёт тут','input_placeholderColor':'#787A19','input_borderColor':'#999999'}"><form action="https://yandex.ru/search/site/" method="get" target="_self" accept-charset="utf-8"><input type="hidden" name="searchid" value="2336348"/><input type="hidden" name="l10n" value="ru"/><input type="hidden" name="reqenc" value=""/><input type="search" name="text" value=""/><input type="submit" value="Найти"/></form></div><style type="text/css">.ya-page_js_yes .ya-site-form_inited_no { display: none; }</style><script type="text/javascript">(function(w,d,c){var s=d.createElement('script'),h=d.getElementsByTagName('script')[0],e=d.documentElement;if((' '+e.className+' ').indexOf(' ya-page_js_yes ')===-1){e.className+=' ya-page_js_yes';}s.type='text/javascript';s.async=true;s.charset='utf-8';s.src=(d.location.protocol==='https:'?'https:':'http:')+'//site.yandex.net/v2.0/js/all.js';h.parentNode.insertBefore(s,h);(w[c]||(w[c]=[])).push(function(){Ya.Site.Form.init()})})(window,document,'yandex_site_callbacks');</script>
</div>
<div id="divbody"><div class="content">
<h3><a class="ablack" href="skript-dlya-poiska-raspuxshix-logov-dokera.html">
Скрипт для поиска распухших логов докера
</a></h3>
<!-- bashblog_timestamp: #202305271344.08# -->
<div class="subtitle">2023-05-27 13:44:08 &mdash; 
Evgeniy Shumilov
</div>
<!-- text begin -->

<p style="text-align:center"><img alt="" src="images/docker-logs.png" /></p>

<p>&nbsp; В который раз уже сталкиваюсь с этой ситуацией. Субботнее утро, хочется немного попрокрастинировать (что при загрузке 60-70 часов в неделю просто жизненно необходимо) и тут начинают сыпаться алерты - заканчивается место на диске одного из рабочих серверов. Как всегда запускаем в <a href="https://sourceforge.net/projects/tmux.mirror/" target="_blank">tmux</a> команду sudo ncdu -x / и ждём. Пришлось ждать минут 40, так как количество файлов на хосте действительно велико, в основном за счёт кешей npm и node modules. И опять ожидаемо обнаружилось, что несколько сотен гигабайт съели логи новых докер контейнеров, запущенных разработчиками на хосте разработки.</p>

<p class="readmore"><a href="skript-dlya-poiska-raspuxshix-logov-dokera.html">Читать дальше...</a></p>
<p>Теги: <a href='tag_docker.html'>docker</a>, <a href='tag_админское.html'>админское</a></p>
<h3><a class="ablack" href="pro-minimalizm-doker-home-assistant-i-resursy.html">
Про минимализм, докер, home assistant и ресурсы
</a></h3>
<!-- bashblog_timestamp: #202006230210.24# -->
<div class="subtitle">2020-06-23 02:10:24 &mdash; 
Evgeniy Shumilov
</div>
<!-- text begin -->

<p style="text-align:center"><img alt="" src="/images/java.jpg" /></p>

<p>&nbsp; Предупрежу на берегу - сейчас будет ворчание старого пер... винтажного газогенератора. Кто не переваривает всю эту &quot;траву, которая раньше была зеленее&quot; - проходите мимо. :)</p>

<p>&nbsp; В мире есть мало вещей, которые меня выводят из себя. И одна из таких вещей - расточительность в отношении ресурсов. Для того, чтобы всем было понятно, представьте, как какой-нибудь олигарх публично жалуется на жизнь, мол, как ему тяжко стало жить! И теперь он в месяц зарабатывает не 20 миллионов, а только 15. В IT мире примерно то же самое. За последние несколько лет индустрия шагнула далеко вперёд и у бизнеса появилась возможность заткнуть любую дыру деньгами или, как ещё говорят - &quot;закидать железом&quot;. Ну и что, что наше приложение обрабатывает за секунду не миллион запросов, а только 100 тысяч - давайте просто купим 10 серверов вместо одного и всё будет ок! Да, зачастую это разумный подход и действительно - проще оплатить аренду более жирной виртуалки, чем платить пару месяцев зарплату всему отделу, который это будет оптимизировать. Но на этих принципах выросло уже целое поколение разработчиков и целая куча продуктов, которые иногда у меня вызывают недоумение. Помнится, в конце 90-х годов шикарной домашней машиной считался Pentium MMX на 166 мегагерц с 32мб оперативной памяти и жёстким диском хорошо, если на 1гб. Сейчас долбаные полоумные часы несут на борту куда более мощное железо. А тогда на этих машинах играли, смотрели кино, слушали музыку, редактировали документы, программировали в конце-концов и вполне успешно!</p>

<p class="readmore"><a href="pro-minimalizm-doker-home-assistant-i-resursy.html">Читать дальше...</a></p>
<p>Теги: <a href='tag_админское.html'>админское</a>, <a href='tag_docker.html'>docker</a>, <a href='tag_minimalism.html'>minimalism</a>, <a href='tag_smarthome.html'>smarthome</a>, <a href='tag_подгорание.html'>подгорание</a></p>
<h3><a class="ablack" href="kontejner-pustyshka-dlya-overlayed-setej-docker-swarm.html">
Контейнер-пустышка для overlayed сетей docker swarm
</a></h3>
<!-- bashblog_timestamp: #201912102201.34# -->
<div class="subtitle">2019-12-10 22:01:34 &mdash; 
Evgeniy Shumilov
</div>
<!-- text begin -->

<p style="text-align:center"><img alt="" src="images/kostyl.jpg" /></p>

<p>&nbsp; В эфире рубрика &quot;Костыли и Велосипеды&quot;.</p>

<p>&nbsp; Не так давно добрались мои руки до docker swarm. Только не нужно напоминать о том, что docker на грани банкротства, а кубернетес правит миром окрестрации&nbsp; контейнеров. Подробно объяснять, что это такое, я не буду. И так достаточно много статей и <a href="https://docs.docker.com/engine/swarm/">документации</a> на эту тему. По сравнению с <a href="https://kubernetes.io/">kubernetes</a>, swarm намного легче и проще в обращении, не требует установки и практически не требует настройки и, что удобно, позволяет пользоваться почти теми же docker-compose файлами с минимальными изменениями для деплоя. Если контейнеров немного, то городить кластер на kubernetes не имеет смысла, swarm для этого вполне подойдёт.</p>

<p class="readmore"><a href="kontejner-pustyshka-dlya-overlayed-setej-docker-swarm.html">Читать дальше...</a></p>
<p>Теги: <a href='tag_админское.html'>админское</a>, <a href='tag_docker.html'>docker</a></p>
<h3><a class="ablack" href="o-pravilnoj-ostanovke-vneshnix-diskov-i-pobedivshej-kontejnerizacii.html">
О правильной остановке внешних дисков и победившей контейнеризации
</a></h3>
<!-- bashblog_timestamp: #201909060014.12# -->
<div class="subtitle">2019-09-06 00:14:12 &mdash; 
Evgeniy Shumilov
</div>
<!-- text begin -->

<p style="text-align:center"><img alt="" src="/images/usbhdd.jpg" /></p>

<p>&nbsp; Надо оставить тут заметку, чтобы не потерять. Возникла у меня проблема - накрылась в очередной раз от периодических отключений питания и отсутствия бесперебойника файловая система на домашнем сервере. Можно было конечно восстанавливать её работоспособность, но объективно было пора переходить на новую. Так как сервер в своё время стоял под телевизором и какое-то время выполнял роль ТВ приставки с Kodi и прочей мультимедией, то на сервере было много всего лишнего,&nbsp;поэтому&nbsp;наиболее идеологически верным было поставить всё с нуля и перенести лишь необходимое. До этого я пользовался <a href="http:///okna-v-okne---pro-evolyuciyu-virtualizacii.html" target="_blank">proxmox</a>, но уже давно мне не нужны были честные виртуальные машины (а когда они будут нужны, проще на рабочей машине поднять виртуалку в VirtualBox), а все необходимые мне сервисы&nbsp;я давно перенёс в докер.&nbsp;</p>

<p class="readmore"><a href="o-pravilnoj-ostanovke-vneshnix-diskov-i-pobedivshej-kontejnerizacii.html">Читать дальше...</a></p>
<p>Теги: <a href='tag_админское.html'>админское</a>, <a href='tag_docker.html'>docker</a>, <a href='tag_hardware.html'>hardware</a>, <a href='tag_linux.html'>linux</a>, <a href='tag_soft.html'>soft</a></p>
<h3><a class="ablack" href="nbspkak-umenshit-razmer-kontejnera-s-python-proektom.html">
Как уменьшить размер контейнера с python проектом
</a></h3>
<!-- bashblog_timestamp: #201905301859.31# -->
<div class="subtitle">2019-05-30 18:59:31 &mdash; 
Evgeniy Shumilov
</div>
<!-- text begin -->

<p style="text-align:center"><img alt="" src="/images/docker-python.png" /></p>

<p>&nbsp; Для многих небольших микросервисов и проектов я использую python. В то же время контейнеры с python внутри не отличаются компактностью. Сегодня на примере одного проекта попробую проиллюстрировать, как избавить контейнер от лишнего веса.</p>

<p class="readmore"><a href="nbspkak-umenshit-razmer-kontejnera-s-python-proektom.html">Читать дальше...</a></p>
<p>Теги: <a href='tag_админское.html'>админское</a>, <a href='tag_containers.html'>containers</a>, <a href='tag_docker.html'>docker</a>, <a href='tag_python.html'>python</a></p>
<h3><a class="ablack" href="otpravka-logov-s-openwrtlede-v-syslog-i-obrabotka-sobytij.html">
Отправка логов с OpenWRT/LEDE в syslog и обработка событий
</a></h3>
<!-- bashblog_timestamp: #201901130231.22# -->
<div class="subtitle">2019-01-13 02:31:22 &mdash; 
Evgeniy Shumilov
</div>
<!-- text begin -->
<p>&nbsp; <img src="/images/syslog/syslogng.png" class="leftimg">Вдогонку к <a href="/pro-centralizovannyj-sbor-logov.html" target="_blank">статье о syslog-ng</a> решил сделать дополнение о том, как завернуть логи с OpenWRT и настроить реакцию на соответствие какому-нибудь фильтру. Дома у меня есть два Xiaomi MiWifi 3G (оказалось крайне доступным и достойным по характеристикам устройством), три штуки Netgear WNR3500L, которые в текущий момент работают в качестве гигабитных свичей в разных частях квартиры и Nexx 3020 для экспериментов. Одним словом, правило для сохранения логов должно быть общее для всех этих устройств, чтобы не писать шесть отдельных конфигурационных файлов. Начать я решил со своего основного Xiaomi роутера с хостнеймом gw01, на котором стоит <a href="https://openwrt.org/releases/18.06/start" target="_blank">OpenWRT 18.06</a>.</p>
<p class="readmore"><a href="otpravka-logov-s-openwrtlede-v-syslog-i-obrabotka-sobytij.html">Читать дальше...</a></p>
<p>Теги: <a href='tag_админское.html'>админское</a>, <a href='tag_docker.html'>docker</a>, <a href='tag_logging.html'>logging</a></p>
<h3><a class="ablack" href="pro-centralizovannyj-sbor-logov.html">
Про централизованный сбор логов
</a></h3>
<!-- bashblog_timestamp: #201901030052.53# -->
<div class="subtitle">2019-01-03 00:52:53 &mdash; 
Evgeniy Shumilov
</div>
<!-- text begin -->

<p style="text-align: center;"><img src="images/syslog/syslogng.png"></p>
<p>&nbsp; За последнее время случилось несколько событий, которые привели меня к необходимости централизованного сбора логов в своей домашней сети.</p>
<h4>Что и зачем собирать?</h4>
<ol>
<li>Периодически ночью отваливается интернет от билайна, хотелось бы видеть, что в этот момент происходит с роутером.</li>
<li>Есть десяток IoT устройств, построенных на ESP8266, которые с прошивкой ESPEasy умеют отправлять логи по сети.</li>
<li>Жена на новый год подарила управляемый гигабитный коммутатор, почему бы не снимать логи и с него, если уж будет такая возможность?</li>
<li>Есть сервер умного дома, работающий на отдельной OrangePI Zero.</li>
<li>Есть около полутора десятков докер и lxc контейнеров с различными службами и pet-проектами, в том числе и этот блог.</li>
</ol>
<p>&nbsp; Хотелось бы хранить все эти логи в одном месте, чтобы облегчить их анализ, ротацию, архивирование и бекап. Как обрабатывать подобную информацию - это уже отдельная задача, но для начала эту информацию нужно собрать.</p>
<p class="readmore"><a href="pro-centralizovannyj-sbor-logov.html">Читать дальше...</a></p>
<p>Теги: <a href='tag_админское.html'>админское</a>, <a href='tag_docker.html'>docker</a>, <a href='tag_logging.html'>logging</a></p>
<h3><a class="ablack" href="ready-for-production.html">
Ready for production
</a></h3>
<!-- bashblog_timestamp: #201811132242.34# -->
<div class="subtitle">2018-11-13 22:42:34 &mdash; 
Evgeniy Shumilov
</div>
<!-- text begin -->

<h1 style="text-align: center;">- Ты видишь контейнер?</h1>
<h1 style="text-align: center;">- Вижу.</h1>
<p style="text-align: center;"><img src="images/shredinger.jpg"></p>
<h1 style="text-align: center;">- И я вижу. А его нет!</h1>
<p>&nbsp; Достаточно давно я заметил где-то фразу о том, что "docker is ready for production". С тех пор периодически вспоминаю её, каждый раз, когда сталкиваюсь с какими-либо проблемами разного масштаба, связанными с докером. Не поймите меня неправильно, мне нравится эта технология, но для меня странным остаётся тот набор детских заболеваний, которыми этот продукт страдает во вполне зрелом возрасте. Так же не понимаю этого дикого ажиотажа вокруг именно докера, когда всё что нужно и не нужно, пытаются затолкнуть в контейнер, не взирая на то, насколько это удобно и целесообразно в текущей ситуации. Создаётся впечатление, что во-первых, раньше не было никакой контейнеризации в принципе - ни jails на BSD, ни <a href="https://openvz.org/" target="_blank">OpenVZ</a>&nbsp;и <a href="https://linuxcontainers.org/lxc/introduction/" target="_blank">LXC</a> на линуксе, а во-вторых - и сейчас нет никаких иных технологий, кроме докера - ни <a href="https://snapcraft.io/" target="_blank">snap</a>/<a href="https://flatpak.org/" target="_blank">flatpack</a> (да-да, иксовые приложения для десктопа тоже пытаются завернуть в докер), ни virtualenv для пайтона - ничего подобного, ни пакетов, ни средств вроде puppet/ansible. Конечно, у докера есть удобные средства доставки, с этим никто не спорит, но не понятно, почему выстрелил в своё время именно он, что его сделало таким "модным, стильным, молодёжным". Скажем, OpenVZ мне нравился откровенно больше, чем LXC, но и тем и другим я пользовался задолго до того, как появился докер. Что помешало обрасти средствами доставки и прочими плюшечками тому же OpenVZ? Отсутствие нативной поддержки в ядре?</p>
<p class="readmore"><a href="ready-for-production.html">Читать дальше...</a></p>
<p>Теги: <a href='tag_docker.html'>docker</a>, <a href='tag_админское.html'>админское</a></p>
</div>
<div id="footer">
<a href="https://vk.com/evgeniy_shumilov">Evgeniy Shumilov</a> &mdash; <a href="mailto:evgeniy&#46;shumilov&#64;gmail&#46;com">evgeniy&#46;shumilov&#64;gmail&#46;com</a><br/>
Generated with <a href="https://github.com/cfenollosa/bashblog">bashblog</a>, a single bash script to easily create blogs like this one</div>
</div></div>
</div></div>
</body></html>
